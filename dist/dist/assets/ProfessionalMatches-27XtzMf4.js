import{j as e}from"./vendor-ui-BOBT-NyQ.js";import{r as n}from"./vendor-LxWyOK1e.js";import{u as k,g as R,B as p,b as m,e as h,a as C,c as F,d as U,j as A,s as g,H,C as I}from"./index-DNN11rcK.js";import{L as f}from"./loader-circle-DBw2VV_h.js";import{R as z}from"./refresh-cw-C9cidl9b.js";import{Z as M}from"./zap-Bxsjf5B5.js";import{U as v}from"./users-BGJJ1iWw.js";import{T as B}from"./target-rxQZ8I7d.js";import{a as W,L as Y,u as Z}from"./vendor-router-hC09K-xx.js";import{T as $,a as q,b as O}from"./tabs-BYN9Ib7m.js";import{U as V}from"./user-BmdG_I6i.js";import{M as G}from"./message-circle-BsyyCNNb.js";import"./vendor-supabase-DciMRLNE.js";import"./vendor-query-BXVzPZ54.js";const J=()=>{const{user:t}=k(),{toast:l}=R(),[r,x]=n.useState([]),[u,o]=n.useState(!0),[c,j]=n.useState(!1),[N,y]=n.useState(!1),b=async(s=!1)=>{if(t){s?y(!0):o(!0);try{const{data:a,error:i}=await g.from("executive_matches").select("*").eq("user_id",t.id).order("created_at",{ascending:!1});if(i)throw i;if(a&&a.length>0){const S=a.map(d=>d.matched_user_id),{data:P,error:_}=await g.from("users").select("id, first_name, last_name, bio, interests, photos").in("id",S);if(_)throw _;const L=a.map(d=>({...d,base_score:d.compatibility_score||85,matched_profile:P?.find(E=>E.id===d.matched_user_id)}));x(L)}else x([])}catch{l({title:"Error",description:"Failed to fetch matches. Please try again.",variant:"destructive"})}finally{o(!1),y(!1)}}},w=async()=>{if(t){j(!0);try{const{data:s,error:a}=await g.functions.invoke("professional-match-trigger",{body:{userId:t.id,preferences:{},timestamp:new Date().toISOString()}});if(a)throw a;l({title:"Success!",description:"New match analysis has been triggered. Check back in a few minutes for results."}),setTimeout(()=>{b(!0)},2e3)}catch{l({title:"Error",description:"Failed to trigger new matches. Please check your connection and try again.",variant:"destructive"})}finally{j(!1)}}};n.useEffect(()=>{b()},[t]);const D=s=>{const a=[];return s.personality_score&&s.personality_score>.7&&a.push("Strong personality compatibility"),s.behavior_score&&s.behavior_score>.7&&a.push("Compatible behavior patterns"),s.embedding_similarity&&s.embedding_similarity>.8&&a.push("Similar interests and values"),s.base_score>80&&a.push("High overall compatibility"),a.length===0&&a.push("Potential compatibility"),a},T=s=>new Date(s).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return u?e.jsxs("div",{className:"flex items-center justify-center min-h-96",children:[e.jsx(f,{className:"h-8 w-8 animate-spin text-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading your matches..."})]}):e.jsxs("div",{className:"w-full max-w-6xl mx-auto p-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Professional Matches"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"AI-powered compatibility matching for busy professionals"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(p,{onClick:()=>b(!0),disabled:N,variant:"outline",className:"border-blue-200 text-blue-700 hover:bg-blue-50",children:[N?e.jsx(f,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(z,{className:"h-4 w-4 mr-2"}),"Refresh"]}),e.jsxs(p,{onClick:w,disabled:c,className:"bg-blue-600 hover:bg-blue-700 text-white shadow-lg",children:[c?e.jsx(f,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(M,{className:"h-4 w-4 mr-2"}),"Find New Matches"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(m,{className:"border-blue-100 bg-gradient-to-br from-blue-50 to-white",children:e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(v,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Matches"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.length})]})]})})}),e.jsx(m,{className:"border-green-100 bg-gradient-to-br from-green-50 to-white",children:e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(B,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"High Compatibility"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.filter(s=>s.base_score>80).length})]})]})})}),e.jsx(m,{className:"border-love-accent/20 bg-love-surface",children:e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(C,{className:"h-8 w-8 text-love-accent"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("p",{className:"text-sm text-love-text-light",children:"This Week"}),e.jsx("p",{className:"text-2xl font-bold text-love-text",children:r.filter(s=>{if(!s.created_at)return!1;const a=new Date(s.created_at),i=new Date;return i.setDate(i.getDate()-7),a>=i}).length})]})]})})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Your Matches"}),r.length===0?e.jsx(m,{className:"border-gray-200",children:e.jsxs(h,{className:"p-8 text-center",children:[e.jsx(v,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No matches yet"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Trigger a new match analysis to find compatible professionals in your area."}),e.jsxs(p,{onClick:w,disabled:c,className:"bg-blue-600 hover:bg-blue-700",children:[c?e.jsx(f,{className:"h-4 w-4 animate-spin mr-2"}):e.jsx(M,{className:"h-4 w-4 mr-2"}),"Find Your First Matches"]})]})}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:r.map(s=>e.jsxs(m,{className:"border-gray-200 hover:border-blue-300 transition-colors shadow-sm hover:shadow-md",children:[e.jsx(F,{className:"pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-love-primary to-love-secondary rounded-full flex items-center justify-center text-white font-medium",children:s.matched_profile?.first_name?.[0]||"M"}),e.jsxs("div",{children:[e.jsx(U,{className:"text-lg",children:s.matched_profile?.first_name&&s.matched_profile?.last_name?`${s.matched_profile.first_name} ${s.matched_profile.last_name}`:"Professional Match"}),e.jsx(A,{children:s.created_at?T(s.created_at):"Recent match"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[s.base_score,"%"]}),e.jsx("div",{className:"text-xs text-gray-500",children:"compatibility"})]})]})}),e.jsxs(h,{className:"pt-0",children:[s.matched_profile?.bio&&e.jsx("p",{className:"text-gray-600 text-sm mb-3 line-clamp-2",children:s.matched_profile.bio}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Match Reasons"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:D(s).map((a,i)=>e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800",children:a},i))})]}),s.matched_profile?.interests&&Array.isArray(s.matched_profile.interests)&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Interests"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.matched_profile.interests.slice(0,3).map((a,i)=>e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-gray-100 text-gray-700",children:a},i)),s.matched_profile.interests.length>3&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+",s.matched_profile.interests.length-3," more"]})]})]})]}),e.jsx("div",{className:"mt-4 pt-3 border-t border-gray-100",children:e.jsx(p,{variant:"outline",size:"sm",className:"w-full border-blue-200 text-blue-700 hover:bg-blue-50",children:"View Full Profile"})})]})]},s.id))})]})]})},K=()=>{const l=W().pathname,r=[{value:"dashboard",label:"Dashboard",path:"/dashboard",icon:V},{value:"discover",label:"Discover",path:"/discover",icon:v},{value:"daily-matches",label:"Daily Matches",path:"/daily-matches",icon:C},{value:"matches",label:"Matches",path:"/matches",icon:H},{value:"messages",label:"Messages",path:"/messages",icon:G},{value:"membership",label:"Membership",path:"/membership",icon:I}];return e.jsx("div",{className:"w-full bg-love-surface/95 backdrop-blur-md border-b border-love-border/50 mb-6 sticky top-0 z-50",children:e.jsx("div",{className:"container mx-auto px-6",children:e.jsx($,{value:l,className:"w-full",children:e.jsx(q,{className:"w-full justify-start overflow-x-auto bg-transparent h-20 p-3 gap-3",children:r.map(({value:x,label:u,path:o,icon:c})=>e.jsx(Y,{to:o,className:"flex-shrink-0",children:e.jsxs(O,{value:o,className:`flex items-center gap-3 px-8 py-4 rounded-2xl 
                  data-[state=active]:bg-gradient-to-r data-[state=active]:from-love-primary data-[state=active]:to-love-secondary 
                  data-[state=active]:text-white data-[state=active]:shadow-xl data-[state=active]:shadow-love-primary/30
                  data-[state=active]:scale-105 data-[state=active]:border-love-primary/50
                  hover:bg-gradient-to-r hover:from-purple-400 hover:to-pink-400 hover:text-white hover:scale-[1.02] hover:border-purple-400 hover:shadow-lg
                  transition-all duration-300 ease-out whitespace-nowrap
                  border-2 border-purple-300 bg-gradient-to-r from-purple-200 to-pink-200 shadow-md
                  font-bold text-purple-800 text-sm
                  backdrop-blur-sm`,children:[e.jsx(c,{className:"h-5 w-5"}),e.jsx("span",{children:u})]})},x))})})})})},he=()=>{const{user:t,loading:l}=k(),r=Z();return n.useEffect(()=>{!l&&!t&&r("/auth")},[t,l,r]),l?e.jsx("div",{className:"min-h-screen bg-love-background flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-love-primary"})}):t?e.jsxs("div",{className:"min-h-screen bg-love-background",children:[e.jsx(K,{}),e.jsx("div",{className:"pt-16",children:e.jsx(J,{})})]}):null};export{he as default};
