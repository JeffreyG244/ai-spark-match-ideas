import{j as e}from"./vendor-ui-BOBT-NyQ.js";import{r as o}from"./vendor-LxWyOK1e.js";import{u as K,g as Q,s as m,B as d,b as p,c as f,d as x,P as H,j as v,e as b,f as T,m as B}from"./index-DNN11rcK.js";import{I as q}from"./input-B8vtTylD.js";import{L as J}from"./label-ggltmGP6.js";import{T as ee,a as se,b as I,c as E}from"./tabs-BYN9Ib7m.js";import{L as te}from"./logo-CkB_3k13.js";import{u as ie}from"./vendor-router-hC09K-xx.js";import{A as ae}from"./arrow-left-dGaAc19p.js";import{C as L}from"./camera-Chtrexk9.js";import{C as G}from"./credit-card-CDgv1eLx.js";import{U as re}from"./users-BGJJ1iWw.js";import{E as ne}from"./eye-5W4z1xL_.js";import{U as oe}from"./upload-wtuO50Cj.js";import{C as le}from"./clock-RrNXdaDL.js";import"./vendor-supabase-DciMRLNE.js";import"./vendor-query-BXVzPZ54.js";const ce=()=>{const{user:n}=K(),{toast:l}=Q(),[g,a]=o.useState(!1),[k,P]=o.useState(null),[y,D]=o.useState(null),[M,F]=o.useState([]),[R,A]=o.useState(!1);o.useEffect(()=>{n&&(c(),j(),h())},[n]);const c=async()=>{if(n)try{const{data:s,error:r}=await m.from("users").select("phone_verified, photo_verified, identity_verified, phone_verified_at, photo_verified_at, identity_verified_at").eq("id",n.id).single();if(r&&r.code!=="PGRST116")return;P(s?{phone_verified:s.phone_verified||!1,photo_verified:s.photo_verified||!1,email_verified:s.identity_verified||!1,phone_verified_at:s.phone_verified_at,photo_verified_at:s.photo_verified_at,email_verified_at:s.identity_verified_at}:{phone_verified:!1,photo_verified:!1,email_verified:!1})}catch{}},j=async()=>{if(n)try{const{data:s,error:r}=await m.from("phone_verifications").select("phone_number, created_at, expires_at").eq("user_id",n.id).order("created_at",{ascending:!1}).limit(1).single();if(r&&r.code!=="PGRST116")return;s&&D({phone_number:s.phone_number,verified_at:s.created_at,code_expires_at:s.expires_at})}catch{}},h=async()=>{if(n)try{const{data:s,error:r}=await m.from("verification_documents").select("id, document_type, file_url, verification_status, created_at").eq("user_id",n.id).order("created_at",{ascending:!1});if(r)return;F(s||[])}catch{}};return{loading:g,verificationStatus:k,phoneVerification:y,documents:M,verificationCodeSent:R,sendVerificationSMS:async s=>{if(!n)return!1;a(!0);try{const{data:r,error:i}=await m.functions.invoke("send-verification-sms",{body:{phoneNumber:s}});if(i)throw i;return A(!0),l({title:"Verification code sent",description:`We've sent a verification code to ${s}`}),r?.verificationCode&&l({title:"Development Mode",description:`Verification code: ${r.verificationCode}`,duration:1e4}),await j(),!0}catch(r){return l({title:"Error",description:r.message||"Failed to send verification code",variant:"destructive"}),!1}finally{a(!1)}},verifyPhoneCode:async(s,r)=>{if(!n)return!1;a(!0);try{const{data:i,error:N}=await m.functions.invoke("verify-phone-code",{body:{phoneNumber:s,verificationCode:r}});if(N)throw N;return l({title:"Phone verified!",description:"Your phone number has been successfully verified."}),await c(),await j(),!0}catch(i){return l({title:"Error",description:i.message||"Invalid verification code",variant:"destructive"}),!1}finally{a(!1)}},uploadDocument:async(s,r)=>{if(!n)return!1;a(!0);try{const i=new FormData;i.append("file",s),i.append("documentType",r);const{data:N,error:C}=await m.functions.invoke("upload-verification-document",{body:i});if(C)throw C;return l({title:"Document uploaded",description:"Your document has been uploaded and is being reviewed."}),await h(),await c(),!0}catch(i){return l({title:"Error",description:i.message||"Failed to upload document",variant:"destructive"}),!1}finally{a(!1)}},addSocialMediaVerification:async(s,r)=>{if(!n)return!1;a(!0);try{const{error:i}=await m.from("social_media_verifications").upsert({user_id:n.id,platform:s,profile_url:r,verification_status:"pending"});if(i)throw i;return l({title:"Social media added",description:`Your ${s} profile has been submitted for verification.`}),!0}catch(i){return l({title:"Error",description:i.message||"Failed to add social media profile",variant:"destructive"}),!1}finally{a(!1)}},fetchVerificationStatus:c,fetchPhoneVerification:j,fetchDocuments:h}},ke=()=>{const{user:n}=K(),l=ie(),{toast:g}=Q(),{loading:a,verificationStatus:k,phoneVerification:P,documents:y,verificationCodeSent:D,sendVerificationSMS:M,verifyPhoneCode:F,uploadDocument:R,addSocialMediaVerification:A}=ce(),[c,j]=o.useState(""),[h,z]=o.useState(""),[w,Y]=o.useState(""),[_,s]=o.useState(""),[r,i]=o.useState("overview"),N=o.useRef(null),C=o.useRef(null),$=async()=>{if(!c.trim()){g({title:"Error",description:"Please enter a valid phone number",variant:"destructive"});return}await M(c)},X=async()=>{if(!h.trim()){g({title:"Error",description:"Please enter the verification code",variant:"destructive"});return}await F(c,h)&&z("")},O=async(t,u)=>{await R(t,u)&&g({title:"Upload Successful",description:`Your ${u} has been uploaded and is being reviewed.`})},Z=async()=>{if(!w||!_.trim()){g({title:"Error",description:"Please select a platform and enter your profile URL",variant:"destructive"});return}await A(w,_)&&(Y(""),s(""))},S=t=>t?e.jsxs(T,{variant:"secondary",className:"bg-green-100 text-green-800",children:[e.jsx(B,{className:"h-3 w-3 mr-1"}),"Verified"]}):e.jsxs(T,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:[e.jsx(le,{className:"h-3 w-3 mr-1"}),"Pending"]}),V=k?.phone_verified||!1,U=k?.photo_verified||!1,W=y.length>0;return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-800 via-purple-900/30 to-slate-800",children:[e.jsx("header",{className:"bg-black/30 backdrop-blur-xl border-b border-purple-500/30 sticky top-0 z-50",children:e.jsx("div",{className:"max-w-7xl mx-auto px-6 py-4",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(d,{variant:"ghost",onClick:()=>l("/dashboard"),className:"text-purple-400 hover:text-purple-300 hover:bg-purple-500/10",children:[e.jsx(ae,{className:"w-5 h-5 mr-2"}),"Dashboard"]}),e.jsx(te,{size:"sm",showText:!0})]})})})}),e.jsxs("div",{className:"container mx-auto px-4 max-w-4xl py-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-white mb-4",children:"Account Verification"}),e.jsx("p",{className:"text-lg text-white/80",children:"Verify your account to build trust and unlock premium features"})]}),e.jsxs(ee,{value:r,onValueChange:i,className:"space-y-6",children:[e.jsxs(se,{className:"grid w-full grid-cols-4 bg-slate-800/60 border-purple-500/30",children:[e.jsx(I,{value:"overview",className:"data-[state=active]:bg-purple-600",children:"Overview"}),e.jsx(I,{value:"phone",className:"data-[state=active]:bg-purple-600",children:"Phone"}),e.jsx(I,{value:"photo",className:"data-[state=active]:bg-purple-600",children:"Photo"}),e.jsx(I,{value:"identity",className:"data-[state=active]:bg-purple-600",children:"Identity"})]}),e.jsx(E,{value:"overview",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(p,{className:"border-green-200/30 bg-green-500/10 backdrop-blur-xl",children:[e.jsxs(f,{children:[e.jsxs(x,{className:"flex items-center gap-2 text-green-300",children:[e.jsx(H,{className:"h-5 w-5"}),"Phone Verification",S(V)]}),e.jsx(v,{className:"text-white/70",children:"Verify your phone number for account security"})]}),e.jsxs(b,{children:[e.jsx("p",{className:"text-sm text-white/60 mb-4",children:"Adding your phone number helps secure your account and enables SMS notifications."}),e.jsx(d,{variant:"outline",size:"sm",onClick:()=>i("phone"),className:"border-green-400/50 text-green-300 hover:bg-green-500/20",children:V?"View Details":"Start Verification"})]})]}),e.jsxs(p,{className:"border-blue-200/30 bg-blue-500/10 backdrop-blur-xl",children:[e.jsxs(f,{children:[e.jsxs(x,{className:"flex items-center gap-2 text-blue-300",children:[e.jsx(L,{className:"h-5 w-5"}),"Photo Verification",S(U)]}),e.jsx(v,{className:"text-white/70",children:"Verify you're a real person with a selfie"})]}),e.jsxs(b,{children:[e.jsx("p",{className:"text-sm text-white/60 mb-4",children:"Take a quick selfie to prove you're the person in your profile photos."}),e.jsx(d,{variant:"outline",size:"sm",onClick:()=>i("photo"),className:"border-blue-400/50 text-blue-300 hover:bg-blue-500/20",children:U?"View Details":"Take Selfie"})]})]}),e.jsxs(p,{className:"border-purple-200/30 bg-purple-500/10 backdrop-blur-xl",children:[e.jsxs(f,{children:[e.jsxs(x,{className:"flex items-center gap-2 text-purple-300",children:[e.jsx(G,{className:"h-5 w-5"}),"Identity Verification",S(W)]}),e.jsx(v,{className:"text-white/70",children:"Verify with government ID for maximum trust"})]}),e.jsxs(b,{children:[e.jsx("p",{className:"text-sm text-white/60 mb-4",children:"Upload a government-issued ID to get the highest level of verification."}),e.jsx(d,{variant:"outline",size:"sm",onClick:()=>i("identity"),className:"border-purple-400/50 text-purple-300 hover:bg-purple-500/20",children:W?"View Documents":"Upload ID"})]})]}),e.jsxs(p,{className:"border-orange-200/30 bg-orange-500/10 backdrop-blur-xl",children:[e.jsxs(f,{children:[e.jsxs(x,{className:"flex items-center gap-2 text-orange-300",children:[e.jsx(re,{className:"h-5 w-5"}),"Social Media",e.jsxs(T,{variant:"secondary",className:"bg-orange-100 text-orange-800",children:[e.jsx(ne,{className:"h-3 w-3 mr-1"}),"Optional"]})]}),e.jsx(v,{className:"text-white/70",children:"Link your social media accounts"})]}),e.jsxs(b,{children:[e.jsx("p",{className:"text-sm text-white/60 mb-4",children:"Connect your social accounts to show authenticity."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("select",{value:w,onChange:t=>Y(t.target.value),className:"px-3 py-2 bg-slate-700 border border-slate-600 rounded text-white text-sm",children:[e.jsx("option",{value:"",children:"Select Platform"}),e.jsx("option",{value:"linkedin",children:"LinkedIn"}),e.jsx("option",{value:"instagram",children:"Instagram"}),e.jsx("option",{value:"twitter",children:"Twitter"}),e.jsx("option",{value:"facebook",children:"Facebook"})]}),e.jsx(q,{placeholder:"Profile URL",value:_,onChange:t=>s(t.target.value),className:"bg-slate-700 border-slate-600 text-white"})]}),e.jsx(d,{variant:"outline",size:"sm",onClick:Z,disabled:a||!w||!_,className:"border-orange-400/50 text-orange-300 hover:bg-orange-500/20 w-full",children:a?"Adding...":"Connect Account"})]})]})]})]})}),e.jsx(E,{value:"phone",className:"space-y-6",children:e.jsxs(p,{className:"bg-slate-800/60 backdrop-blur-xl border-purple-500/30",children:[e.jsxs(f,{children:[e.jsxs(x,{className:"flex items-center gap-2 text-white",children:[e.jsx(H,{className:"h-5 w-5"}),"Phone Verification",S(V)]}),e.jsx(v,{className:"text-white/70",children:"Enter your phone number to receive a verification code"})]}),e.jsxs(b,{className:"space-y-4",children:[!V&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(J,{htmlFor:"phone",className:"text-white",children:"Phone Number"}),e.jsx(q,{id:"phone",type:"tel",placeholder:"+1 (555) 123-4567",value:c,onChange:t=>j(t.target.value),className:"bg-slate-700 border-slate-600 text-white",disabled:D})]}),D?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(J,{htmlFor:"code",className:"text-white",children:"Verification Code"}),e.jsx(q,{id:"code",placeholder:"Enter 6-digit code",value:h,onChange:t=>z(t.target.value),className:"bg-slate-700 border-slate-600 text-white",maxLength:6})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{onClick:X,disabled:a||!h,className:"bg-green-600 hover:bg-green-700",children:a?"Verifying...":"Verify Code"}),e.jsx(d,{variant:"outline",onClick:$,disabled:a,className:"border-purple-400/50 text-purple-300 hover:bg-purple-500/20",children:"Resend Code"})]})]}):e.jsx(d,{onClick:$,disabled:a||!c,className:"bg-purple-600 hover:bg-purple-700",children:a?"Sending...":"Send Verification Code"})]}),V&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(B,{className:"h-16 w-16 text-green-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"Phone Verified!"}),e.jsx("p",{className:"text-white/70",children:"Your phone number has been successfully verified."}),P?.phone_number&&e.jsxs("p",{className:"text-purple-300 mt-2",children:["Verified: ",P.phone_number]})]})]})]})}),e.jsx(E,{value:"photo",className:"space-y-6",children:e.jsxs(p,{className:"bg-slate-800/60 backdrop-blur-xl border-purple-500/30",children:[e.jsxs(f,{children:[e.jsxs(x,{className:"flex items-center gap-2 text-white",children:[e.jsx(L,{className:"h-5 w-5"}),"Photo Verification",S(U)]}),e.jsx(v,{className:"text-white/70",children:"Upload a selfie to verify your identity"})]}),e.jsx(b,{children:U?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(B,{className:"h-16 w-16 text-green-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"Photo Verified!"}),e.jsx("p",{className:"text-white/70",children:"Your selfie has been successfully verified."})]}):e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"w-32 h-32 bg-slate-700 rounded-full mx-auto flex items-center justify-center",children:e.jsx(L,{className:"h-12 w-12 text-slate-400"})}),e.jsx("p",{className:"text-sm text-white/60",children:"We'll compare this selfie with your profile photos to verify it's really you"}),e.jsx("input",{ref:N,type:"file",accept:"image/*",className:"hidden",onChange:t=>{const u=t.target.files?.[0];u&&O(u,"selfie")}}),e.jsxs(d,{onClick:()=>N.current?.click(),disabled:a,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(L,{className:"h-4 w-4 mr-2"}),a?"Uploading...":"Upload Selfie"]})]})})]})}),e.jsx(E,{value:"identity",className:"space-y-6",children:e.jsxs(p,{className:"bg-slate-800/60 backdrop-blur-xl border-purple-500/30",children:[e.jsxs(f,{children:[e.jsxs(x,{className:"flex items-center gap-2 text-white",children:[e.jsx(G,{className:"h-5 w-5"}),"Identity Verification"]}),e.jsx(v,{className:"text-white/70",children:"Upload a government-issued ID for the highest level of verification"})]}),e.jsx(b,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border-2 border-dashed border-slate-600 rounded-lg p-6 text-center",children:[e.jsx(G,{className:"h-12 w-12 mx-auto text-slate-400 mb-4"}),e.jsx("p",{className:"text-sm text-white/60 mb-4",children:"Upload your government-issued ID (driver's license, passport, etc.)"}),e.jsx("input",{ref:C,type:"file",accept:"image/*,.pdf",className:"hidden",onChange:t=>{const u=t.target.files?.[0];u&&O(u,"government_id")}}),e.jsxs(d,{variant:"outline",className:"border-purple-400/50 text-purple-300 hover:bg-purple-500/20",onClick:()=>C.current?.click(),disabled:a,children:[e.jsx(oe,{className:"h-4 w-4 mr-2"}),a?"Uploading...":"Choose File"]})]}),y.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-white font-medium",children:"Uploaded Documents"}),y.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-700 rounded",children:[e.jsx("span",{className:"text-white text-sm",children:t.document_type.replace("_"," ").toUpperCase()}),e.jsx(T,{variant:t.verification_status==="approved"?"default":"secondary",className:t.verification_status==="approved"?"bg-green-600":"bg-yellow-600",children:t.verification_status})]},t.id))]}),e.jsxs("div",{className:"text-xs text-white/50",children:[e.jsx("p",{children:"• Accepted formats: JPG, PNG, PDF"}),e.jsx("p",{children:"• Maximum file size: 10MB"}),e.jsx("p",{children:"• Your information is encrypted and secure"})]})]})})]})})]})]})]})};export{ke as default};
