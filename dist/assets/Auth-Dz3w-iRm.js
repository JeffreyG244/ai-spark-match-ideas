import{j as e}from"./vendor-ui-BOBT-NyQ.js";import{r as m}from"./vendor-LxWyOK1e.js";import{u as P,b as w,c as y,d as N,e as k,B as u,f as I,t as n,s as F}from"./index-DNN11rcK.js";import{I as g}from"./input-B8vtTylD.js";import{L as l}from"./label-ggltmGP6.js";import{T as L}from"./textarea-CyRvzfXF.js";import{L as S}from"./logo-CkB_3k13.js";import{u as A}from"./vendor-router-hC09K-xx.js";import{A as E}from"./arrow-left-dGaAc19p.js";import"./vendor-supabase-DciMRLNE.js";import"./vendor-query-BXVzPZ54.js";const D=()=>{const{signUp:f,user:p}=P(),[h,v]=m.useState(1),[o,c]=m.useState(!1),[s,i]=m.useState({email:"",password:"",firstName:"",lastName:"",age:18,location:"",bio:"",interests:[]}),j=["Travel","Fitness","Music","Food","Art","Sports","Movies","Reading","Photography","Dancing","Hiking","Cooking","Gaming","Fashion","Tech","Yoga"],x=t=>{i(a=>({...a,interests:a.interests.includes(t)?a.interests.filter(r=>r!==t):[...a.interests,t]}))},b=async()=>{if(!s.email||!s.password||!s.firstName){n({title:"Missing Information",description:"Please fill in all required fields.",variant:"destructive"});return}c(!0);try{await f(s.email,s.password,s.password,s.firstName,s.lastName),v(2)}catch{n({title:"Sign Up Failed",description:"Please try again.",variant:"destructive"})}finally{c(!1)}},C=async()=>{if(!p){n({title:"Authentication Error",description:"Please sign in again to complete your profile.",variant:"destructive"});return}c(!0);try{const t={id:p.id,email:s.email,first_name:s.firstName,last_name:s.lastName,date_of_birth:new Date(new Date().getFullYear()-s.age,0,1).toISOString().split("T")[0],city:s.location||"Unknown",bio:s.bio||`${s.firstName} from ${s.location}. Age ${s.age}.`,photos:[],created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{data:a,error:r}=await F.from("users").upsert(t).select();if(r)throw r;try{await F.functions.invoke("send-welcome-email",{body:{email:s.email,firstName:s.firstName,lastName:s.lastName}})}catch{}n({title:"Welcome to the community!",description:"Your profile has been created successfully. Check your email for a welcome message!"}),setTimeout(()=>{window.location.href="/dashboard"},1e3)}catch(t){const a=t instanceof Error?t.message:"Unknown error occurred";n({title:"Profile Creation Failed",description:`Error: ${a}. Please try again or contact support.`,variant:"destructive"})}finally{c(!1)}};return h===1?e.jsx("div",{className:"min-h-screen bg-love-background flex items-center justify-center p-4",children:e.jsxs(w,{className:"w-full max-w-md shadow-xl border-0",children:[e.jsxs(y,{className:"text-center pb-2",children:[e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsx(S,{size:"lg"})}),e.jsx(N,{className:"text-2xl font-bold bg-gradient-to-r from-pink-600 to-purple-600 bg-clip-text text-transparent",children:"Join Our Community"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Find meaningful connections"})]}),e.jsxs(k,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"firstName",children:"First Name"}),e.jsx(g,{id:"firstName",value:s.firstName,onChange:t=>i(a=>({...a,firstName:t.target.value})),placeholder:"John"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"lastName",children:"Last Name"}),e.jsx(g,{id:"lastName",value:s.lastName,onChange:t=>i(a=>({...a,lastName:t.target.value})),placeholder:"Doe"})]})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"email",children:"Email"}),e.jsx(g,{id:"email",type:"email",value:s.email,onChange:t=>i(a=>({...a,email:t.target.value})),placeholder:"john@example.com"})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"password",children:"Password"}),e.jsx(g,{id:"password",type:"password",value:s.password,onChange:t=>i(a=>({...a,password:t.target.value})),placeholder:"Choose a strong password"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"age",children:"Age"}),e.jsx(g,{id:"age",type:"number",min:"18",max:"100",value:s.age,onChange:t=>i(a=>({...a,age:parseInt(t.target.value)||18}))})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"location",children:"Location"}),e.jsx(g,{id:"location",value:s.location,onChange:t=>i(a=>({...a,location:t.target.value})),placeholder:"City, State"})]})]}),e.jsx(u,{onClick:b,disabled:o,className:"w-full bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white font-semibold py-6 text-lg",children:o?"Creating Account...":"Create Account"})]})]})}):e.jsx("div",{className:"min-h-screen bg-love-background flex items-center justify-center p-4",children:e.jsxs(w,{className:"w-full max-w-md shadow-xl border-0",children:[e.jsxs(y,{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsx(S,{size:"lg"})}),e.jsx(N,{className:"text-2xl font-bold",children:"Complete Your Profile"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Tell us about yourself"})]}),e.jsxs(k,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"bio",children:"About Me"}),e.jsx(L,{id:"bio",value:s.bio,onChange:t=>i(a=>({...a,bio:t.target.value})),placeholder:"Tell potential matches about yourself...",rows:3})]}),e.jsxs("div",{children:[e.jsx(l,{children:"Interests"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:j.map(t=>e.jsx(I,{variant:s.interests.includes(t)?"default":"outline",className:`cursor-pointer transition-all ${s.interests.includes(t)?"bg-gradient-to-r from-pink-500 to-purple-600 text-white":"hover:border-pink-300"}`,onClick:()=>x(t),children:t},t))})]}),e.jsx(u,{onClick:C,disabled:o,className:"w-full bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white font-semibold py-6 text-lg",children:o?"Setting Up Profile...":"Complete Profile"})]})]})})},T=()=>{const{signIn:f}=P(),[p,h]=m.useState(!1),[v,o]=m.useState(!1),[c,s]=m.useState(""),[i,j]=m.useState(!1),[x,b]=m.useState({email:"",password:""}),C=async a=>{if(a.preventDefault(),!x.email||!x.password){n({title:"Missing Information",description:"Please enter both email and password.",variant:"destructive"});return}h(!0);try{await f(x.email,x.password)}catch(r){let d="Please check your credentials and try again.";r?.message?.includes("Invalid login credentials")?d="Invalid email or password. Please double-check your credentials.":r?.message?.includes("Email not confirmed")?d="Please check your email and click the confirmation link before signing in.":r?.message?.includes("Too many requests")&&(d="Too many login attempts. Please wait a few minutes before trying again."),n({title:"Sign In Failed",description:d,variant:"destructive"})}finally{h(!1)}},t=async a=>{if(a.preventDefault(),!c){n({title:"Email Required",description:"Please enter your email address.",variant:"destructive"});return}j(!0);try{const{data:r,error:d}=await F.functions.invoke("send-password-reset",{body:{email:c}});d?n({title:"Reset Failed",description:`Error: ${d.message}. Please try again or contact support.`,variant:"destructive"}):(n({title:"âœ… Reset Email Sent!",description:`A password reset link has been sent to ${c}. Please check your email (including spam folder).`,duration:6e3}),s(""),setTimeout(()=>{o(!1)},2e3))}catch(r){const d=r instanceof Error?r.message:"Unknown error occurred";n({title:"Reset Failed",description:`Unexpected error: ${d}. Please try again or contact support.`,variant:"destructive"})}finally{j(!1)}};return v?e.jsx("div",{className:"min-h-screen bg-love-background flex items-center justify-center p-4",children:e.jsxs(w,{className:"w-full max-w-md shadow-xl border-0",children:[e.jsxs(y,{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsx(S,{size:"lg"})}),e.jsx(N,{className:"text-2xl font-bold bg-gradient-to-r from-pink-600 to-purple-600 bg-clip-text text-transparent",children:"Reset Your Password"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Enter your email to receive a password reset link"})]}),e.jsxs(k,{children:[e.jsxs("form",{onSubmit:t,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"resetEmail",children:"Email Address"}),e.jsx(g,{id:"resetEmail",type:"email",value:c,onChange:a=>s(a.target.value),placeholder:"Enter your email address",required:!0,disabled:i})]}),e.jsx(u,{type:"submit",disabled:i||!c.trim(),className:"w-full bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white font-semibold py-6 text-lg",children:i?"Sending Reset Link...":"Send Reset Link"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx(u,{variant:"ghost",onClick:()=>{o(!1),s("")},disabled:i,className:"text-gray-600 hover:text-gray-800",children:"Back to Sign In"})})]})]})}):e.jsx("div",{className:"min-h-screen bg-love-background flex items-center justify-center p-4",children:e.jsxs(w,{className:"w-full max-w-md shadow-xl border-0",children:[e.jsxs(y,{className:"text-center",children:[e.jsx("div",{className:"flex items-center justify-center mb-6",children:e.jsx(S,{size:"lg"})}),e.jsx(N,{className:"text-2xl font-bold bg-gradient-to-r from-pink-600 to-purple-600 bg-clip-text text-transparent",children:"Welcome Back"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Sign in to continue your journey"})]}),e.jsxs(k,{children:[e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(l,{htmlFor:"email",children:"Email"}),e.jsx(g,{id:"email",type:"email",value:x.email,onChange:a=>b(r=>({...r,email:a.target.value})),placeholder:"Enter your email",required:!0})]}),e.jsxs("div",{children:[e.jsx(l,{htmlFor:"password",children:"Password"}),e.jsx(g,{id:"password",type:"password",value:x.password,onChange:a=>b(r=>({...r,password:a.target.value})),placeholder:"Enter your password",required:!0})]}),e.jsx(u,{type:"submit",disabled:p,className:"w-full bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 text-white font-semibold py-6 text-lg mt-6",children:p?"Signing In...":"Sign In"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx(u,{variant:"ghost",onClick:()=>o(!0),className:"text-gray-600 hover:text-gray-800 text-sm",children:"Forgot your password?"})})]})]})})},J=()=>{const{user:f,loading:p}=P(),h=A(),[v,o]=m.useState("signup");return m.useEffect(()=>{!p&&f&&h("/dashboard")},[f,p,h]),p?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-pink-50 via-white to-purple-50 flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-pink-600"})}):v==="signup"?e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute top-4 left-4 z-10",children:e.jsxs(u,{variant:"ghost",onClick:()=>h("/"),className:"text-gray-600 hover:text-gray-800",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Back to Home"]})}),e.jsx("div",{className:"absolute top-4 right-4 z-10",children:e.jsx(u,{variant:"outline",onClick:()=>o("login"),className:"border-pink-200 text-pink-600 hover:bg-pink-50",children:"Already have an account? Sign In"})}),e.jsx(D,{})]}):e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute top-4 left-4 z-10",children:e.jsxs(u,{variant:"ghost",onClick:()=>h("/"),className:"text-gray-600 hover:text-gray-800",children:[e.jsx(E,{className:"h-4 w-4 mr-2"}),"Back to Home"]})}),e.jsx("div",{className:"absolute top-4 right-4 z-10",children:e.jsx(u,{variant:"outline",onClick:()=>o("signup"),className:"border-pink-200 text-pink-600 hover:bg-pink-50",children:"Need an account? Sign Up"})}),e.jsx(T,{})]})};export{J as default};
